{"ast":null,"code":"import _slicedToArray from\"C:/Users/ANKUR KUMAR/Videos/AIVLOG-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"C:/Users/ANKUR KUMAR/Videos/AIVLOG-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ANKUR KUMAR/Videos/AIVLOG-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/* eslint-disable no-unused-vars */import axios from'axios';import{API_NOTIFICATION_MESSAGES,SERVICE_URLS}from'../constants/config';import{getAccessToken,getRefreshToken,setAccessToken,getType}from'../utils/common-utils';var API_URL='https://localhost:8000';var axiosInstance=axios.create({baseURL:API_URL,timeout:10000,headers:{\"content-type\":\"application/json\"}});axiosInstance.interceptors.request.use(function(config){if(config.TYPE.params){config.params=config.TYPE.params;}else if(config.TYPE.query){config.url=config.url+'/'+config.TYPE.query;}return config;},function(error){return Promise.reject(error);});axiosInstance.interceptors.response.use(function(response){// Stop global loader here\nreturn processResponse(response);},function(error){// Stop global loader here\nreturn Promise.reject(ProcessError(error));});///////////////////////////////\n// If success -> returns { isSuccess: true, data: object }\n// If fail -> returns { isFailure: true, status: string, msg: string, code: int }\n//////////////////////////////\nvar processResponse=function processResponse(response){if((response===null||response===void 0?void 0:response.status)===200){return{isSuccess:true,data:response.data};}else{return{isFailure:true,status:response===null||response===void 0?void 0:response.status,msg:response===null||response===void 0?void 0:response.msg,code:response===null||response===void 0?void 0:response.code};}};///////////////////////////////\n// If success -> returns { isSuccess: true, data: object }\n// If fail -> returns { isError: true, status: string, msg: string, code: int }\n//////////////////////////////\nvar ProcessError=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(error){var _error$response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!error.response){_context.next=9;break;}if(!(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===403)){_context.next=5;break;}// const { url, config } = error.response;\n// console.log(error);\n// try {\n//     let response = await API.getRefreshToken({ token: getRefreshToken() });\n//     if (response.isSuccess) {\nsessionStorage.clear();//         setAccessToken(response.data.accessToken);\n//         const requestData = error.toJSON();\n//         let response1 = await axios({\n//             method: requestData.config.method,\n//             url: requestData.config.baseURL + requestData.config.url,\n//             headers: { \"content-type\": \"application/json\", \"authorization\": getAccessToken() },\n//             params: requestData.config.params\n//         });\n//     }\n// } catch (error) {\n//     return Promise.reject(error)\n// }\n_context.next=7;break;case 5:console.log(\"ERROR IN RESPONSE: \",error.toJSON());return _context.abrupt(\"return\",{isError:true,msg:API_NOTIFICATION_MESSAGES.responseFailure,code:error.response.status});case 7:_context.next=16;break;case 9:if(!error.request){_context.next=14;break;}// The request was made but no response was received\nconsole.log(\"ERROR IN RESPONSE: \",error.toJSON());return _context.abrupt(\"return\",{isError:true,msg:API_NOTIFICATION_MESSAGES.requestFailure,code:\"\"});case 14:// Something happened in setting up the request that triggered an Error\nconsole.log(\"ERROR IN RESPONSE: \",error.toJSON());return _context.abrupt(\"return\",{isError:true,msg:API_NOTIFICATION_MESSAGES.networkError,code:\"\"});case 16:case\"end\":return _context.stop();}}},_callee);}));return function ProcessError(_x){return _ref.apply(this,arguments);};}();var API={};var _loop=function _loop(){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];API[key]=function(body,showUploadProgress,showDownloadProgress){return axiosInstance({method:value.method,url:value.url,data:value.method==='DELETE'?'':body,responseType:value.responseType,headers:{authorization:getAccessToken()},TYPE:getType(value,body),onUploadProgress:function onUploadProgress(progressEvent){if(showUploadProgress){var percentCompleted=Math.round(progressEvent.loaded*100/progressEvent.total);showUploadProgress(percentCompleted);}},onDownloadProgress:function onDownloadProgress(progressEvent){if(showDownloadProgress){var percentCompleted=Math.round(progressEvent.loaded*100/progressEvent.total);showDownloadProgress(percentCompleted);}}});};};for(var _i=0,_Object$entries=Object.entries(SERVICE_URLS);_i<_Object$entries.length;_i++){_loop();}export{API};","map":{"version":3,"names":["axios","API_NOTIFICATION_MESSAGES","SERVICE_URLS","getAccessToken","getRefreshToken","setAccessToken","getType","API_URL","axiosInstance","create","baseURL","timeout","headers","interceptors","request","use","config","TYPE","params","query","url","error","Promise","reject","response","processResponse","ProcessError","status","isSuccess","data","isFailure","msg","code","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_error$response","wrap","_callee$","_context","prev","next","sessionStorage","clear","console","log","toJSON","abrupt","isError","responseFailure","requestFailure","networkError","stop","_x","apply","arguments","API","_loop","_Object$entries$_i","_slicedToArray","_Object$entries","_i","key","value","body","showUploadProgress","showDownloadProgress","method","responseType","authorization","onUploadProgress","progressEvent","percentCompleted","Math","round","loaded","total","onDownloadProgress","Object","entries","length"],"sources":["C:/Users/ANKUR KUMAR/Videos/AIVLOG-main/client/src/service/api.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport axios from 'axios';\r\n\r\nimport { API_NOTIFICATION_MESSAGES, SERVICE_URLS } from '../constants/config';\r\nimport { getAccessToken, getRefreshToken, setAccessToken, getType } from '../utils/common-utils';\r\n\r\nconst API_URL = 'https://localhost:8000';\r\n\r\nconst axiosInstance = axios.create({\r\n    baseURL: API_URL,\r\n    timeout: 10000, \r\n    headers: {\r\n        \"content-type\": \"application/json\"\r\n    }\r\n});\r\n\r\naxiosInstance.interceptors.request.use(\r\n    function(config) {\r\n        if (config.TYPE.params) {\r\n            config.params = config.TYPE.params\r\n        } else if (config.TYPE.query) {\r\n            config.url = config.url + '/' + config.TYPE.query;\r\n        }\r\n        return config;\r\n    },\r\n    function(error) {\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\naxiosInstance.interceptors.response.use(\r\n    function(response) {\r\n        // Stop global loader here\r\n        return processResponse(response);\r\n    },\r\n    function(error) {\r\n        // Stop global loader here\r\n        return Promise.reject(ProcessError(error));\r\n    }\r\n)\r\n\r\n///////////////////////////////\r\n// If success -> returns { isSuccess: true, data: object }\r\n// If fail -> returns { isFailure: true, status: string, msg: string, code: int }\r\n//////////////////////////////\r\nconst processResponse = (response) => {\r\n    if (response?.status === 200) {\r\n        return { isSuccess: true, data: response.data }\r\n    } else {\r\n        return {\r\n            isFailure: true,\r\n            status: response?.status,\r\n            msg: response?.msg,\r\n            code: response?.code\r\n        }\r\n    }\r\n}\r\n\r\n///////////////////////////////\r\n// If success -> returns { isSuccess: true, data: object }\r\n// If fail -> returns { isError: true, status: string, msg: string, code: int }\r\n//////////////////////////////\r\nconst ProcessError = async (error) => {\r\n    if (error.response) {\r\n        // Request made and server responded with a status code \r\n        // that falls out of the range of 2xx\r\n        if (error.response?.status === 403) {\r\n            // const { url, config } = error.response;\r\n            // console.log(error);\r\n            // try {\r\n            //     let response = await API.getRefreshToken({ token: getRefreshToken() });\r\n            //     if (response.isSuccess) {\r\n                    sessionStorage.clear();\r\n            //         setAccessToken(response.data.accessToken);\r\n\r\n            //         const requestData = error.toJSON();\r\n\r\n            //         let response1 = await axios({\r\n            //             method: requestData.config.method,\r\n            //             url: requestData.config.baseURL + requestData.config.url,\r\n            //             headers: { \"content-type\": \"application/json\", \"authorization\": getAccessToken() },\r\n            //             params: requestData.config.params\r\n            //         });\r\n            //     }\r\n            // } catch (error) {\r\n            //     return Promise.reject(error)\r\n            // }\r\n        } else {\r\n            console.log(\"ERROR IN RESPONSE: \", error.toJSON());\r\n            return {\r\n                isError: true,\r\n                msg: API_NOTIFICATION_MESSAGES.responseFailure,\r\n                code: error.response.status\r\n            }\r\n        }\r\n    } else if (error.request) { \r\n        // The request was made but no response was received\r\n        console.log(\"ERROR IN RESPONSE: \", error.toJSON());\r\n        return {\r\n            isError: true,\r\n            msg: API_NOTIFICATION_MESSAGES.requestFailure,\r\n            code: \"\"\r\n        }\r\n    } else { \r\n        // Something happened in setting up the request that triggered an Error\r\n        console.log(\"ERROR IN RESPONSE: \", error.toJSON());\r\n        return {\r\n            isError: true,\r\n            msg: API_NOTIFICATION_MESSAGES.networkError,\r\n            code: \"\"\r\n        }\r\n    }\r\n}\r\n\r\nconst API = {};\r\n\r\nfor (const [key, value] of Object.entries(SERVICE_URLS)) {\r\n    API[key] = (body, showUploadProgress, showDownloadProgress) =>\r\n        axiosInstance({\r\n            method: value.method,\r\n            url: value.url,\r\n            data: value.method === 'DELETE' ? '' : body,\r\n            responseType: value.responseType,\r\n            headers: {\r\n                authorization: getAccessToken(),\r\n            },\r\n            TYPE: getType(value, body),\r\n            onUploadProgress: function(progressEvent) {\r\n                if (showUploadProgress) {\r\n                    let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n                    showUploadProgress(percentCompleted);\r\n                }\r\n            },\r\n            onDownloadProgress: function(progressEvent) {\r\n                if (showDownloadProgress) {\r\n                    let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n                    showDownloadProgress(percentCompleted);\r\n                }\r\n            }\r\n        });\r\n}\r\n\r\nexport { API };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}